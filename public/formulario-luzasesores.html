<!-- FORMULARIO LUZASESORES - Integración perfecta con WordPress -->
<style>
    /* Reset de estilos WordPress */
    #formulario-luzasesores,
    #formulario-luzasesores * {
        box-sizing: border-box;
    }

    #formulario-luzasesores {
        width: 100%;
        padding: 30px;
        background: transparent;
        margin: 0;
        overflow: visible;
    }

    #formulario-luzasesores form {
        width: 100%;
        margin: 0;
        padding: 0;
    }

    #formulario-luzasesores input,
    #formulario-luzasesores textarea {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
        padding: 12px !important;
        border: 1px solid #ddd !important;
        border-radius: 6px !important;
        font-size: 14px !important;
        font-family: inherit !important;
        box-sizing: border-box !important;
        transition: border-color 0.3s !important;
    }

    #formulario-luzasesores button {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
        padding: 14px !important;
        box-sizing: border-box !important;
    }

    /* Responsive */
    @media (max-width: 768px) {
        #formulario-luzasesores {
            padding: 20px;
        }
    }

    @media (max-width: 480px) {
        #formulario-luzasesores {
            padding: 15px;
        }
    }
</style>

<div id="formulario-luzasesores">
    <div id="mensaje-luzasesores" style="padding: 15px; border-radius: 6px; margin-bottom: 20px; font-size: 14px; display: none;"></div>

    <form id="contactForm-luzasesores">
        <!-- Nombre y Apellidos -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
            <div>
                <label for="nombre-luzasesores" style="display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 14px;">Nombre *</label>
                <input type="text" id="nombre-luzasesores" name="nombre" required style="border-color: #ddd !important;" onmouseover="this.style.borderColor='#7d9b76'" onmouseout="this.style.borderColor='#ddd'">
            </div>
            <div>
                <label for="apellidos-luzasesores" style="display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 14px;">Apellidos *</label>
                <input type="text" id="apellidos-luzasesores" name="apellidos" required style="border-color: #ddd !important;" onmouseover="this.style.borderColor='#7d9b76'" onmouseout="this.style.borderColor='#ddd'">
            </div>
        </div>

        <!-- Email y Teléfono -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
            <div>
                <label for="email-luzasesores" style="display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 14px;">Email *</label>
                <input type="email" id="email-luzasesores" name="email" required style="border-color: #ddd !important;" onmouseover="this.style.borderColor='#7d9b76'" onmouseout="this.style.borderColor='#ddd'">
            </div>
            <div>
                <label for="telefono-luzasesores" style="display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 14px;">Teléfono *</label>
                <input type="tel" id="telefono-luzasesores" name="telefono" required style="border-color: #ddd !important;" onmouseover="this.style.borderColor='#7d9b76'" onmouseout="this.style.borderColor='#ddd'">
            </div>
        </div>

        <!-- Mensaje -->
        <div style="margin-bottom: 25px;">
            <label for="mensaje" style="display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 14px;">Mensaje *</label>
            <textarea id="mensaje" name="mensaje" required style="min-height: 120px !important; resize: vertical !important; border-color: #ddd !important;" onmouseover="this.style.borderColor='#7d9b76'" onmouseout="this.style.borderColor='#ddd'"></textarea>
        </div>

        <!-- Botón -->
        <button type="submit" id="submitBtn-luzasesores" style="background: #7d9b76 !important; color: white !important; border: none !important; border-radius: 6px !important; font-size: 16px !important; font-weight: 600 !important; cursor: pointer !important; transition: background 0.3s, transform 0.2s !important;" onmouseover="this.style.background='#6b8663'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='#7d9b76'; this.style.transform='translateY(0)'">Enviar Mensaje</button>
    </form>
</div>

<script>
    const form = document.getElementById('contactForm-luzasesores');
    const messageDiv = document.getElementById('mensaje-luzasesores');
    const submitBtn = document.getElementById('submitBtn-luzasesores');

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        messageDiv.style.display = 'none';
        messageDiv.textContent = '';

        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = '⏳ Enviando (puede tardar unos segundos)...';

        try {
            const formData = {
                nombre: document.getElementById('nombre-luzasesores').value,
                apellidos: document.getElementById('apellidos-luzasesores').value,
                email: document.getElementById('email-luzasesores').value,
                telefono: document.getElementById('telefono-luzasesores').value,
                mensaje: document.getElementById('mensaje').value,
                slug: 'luzasesores-leads'
            };

            const response = await fetch('https://app.alfredosimon.com:3000/api/formularios/submit', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData),
                timeout: 60000  // 60 segundos de timeout
            });

            const data = await response.json();

            if (data.success) {
                messageDiv.style.background = '#e8f5e9';
                messageDiv.style.color = '#2e7d32';
                messageDiv.style.border = '1px solid #66bb6a';
                messageDiv.textContent = '✓ ¡Mensaje enviado correctamente! Nos pondremos en contacto pronto.';
                messageDiv.style.display = 'block';
                form.reset();
                document.getElementById('mensaje').value = '';
            } else {
                messageDiv.style.background = '#ffebee';
                messageDiv.style.color = '#c62828';
                messageDiv.style.border = '1px solid #ef5350';
                messageDiv.textContent = '✗ ' + (data.error || 'Error al enviar el mensaje');
                messageDiv.style.display = 'block';
            }
        } catch (error) {
            console.error('Error completo:', error);
            messageDiv.style.background = '#ffebee';
            messageDiv.style.color = '#c62828';
            messageDiv.style.border = '1px solid #ef5350';
            messageDiv.textContent = '✗ Error de conexión. Verifica tu conexión a internet y intenta de nuevo.';
            messageDiv.style.display = 'block';
        } finally {
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        }
    });

    // Responsive dinámico
    function makeFormResponsive() {
        const form = document.getElementById('contactForm-luzasesores');
        const gridDivs = form.querySelectorAll('div[style*="grid-template-columns"]');
        
        gridDivs.forEach(div => {
            if (window.innerWidth <= 768) {
                div.style.gridTemplateColumns = '1fr !important';
                div.style.gap = '15px !important';
            } else {
                div.style.gridTemplateColumns = '1fr 1fr !important';
                div.style.gap = '20px !important';
            }
        });
    }

    makeFormResponsive();
    window.addEventListener('resize', makeFormResponsive);
</script>
